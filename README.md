# AI Companion - è®¤çŸ¥æ¶æ„æ¡†æ¶ (Cognitive Architecture Framework)

![License](https://img.shields.io/badge/license-MIT-blue.svg) ![Flutter](https://img.shields.io/badge/Flutter-3.0%2B-02569B) ![Dart](https://img.shields.io/badge/Dart-3.0%2B-0175C2)

**[English](README_EN.md) | [ä¸­æ–‡](README.md)**

> **v2.8.0 æ›´æ–°**: ç•Œé¢ç¾åŒ–å‡çº§ï¼æ–°å¢ä¸‹æ‹‰å¼æ€§åˆ«é€‰æ‹©ã€å…¨å±€å‘¼å¸åŠ¨ç”»åé¦ˆå¼¹çª—ï¼Œå¹¶ä¼˜åŒ–äº† Prompt æœ¬åœ°åŒ–ä½“éªŒã€‚

---

## ä¸­æ–‡æ–‡æ¡£

**AI Companion** æ˜¯ä¸€ä¸ªç”±**é—­ç¯è®¤çŸ¥æ¶æ„**é©±åŠ¨çš„â€œæ•°å­—ç”Ÿå‘½â€æ¡†æ¶ã€‚ä¸ç®€å•çš„å¥—å£³ LLM ä¸åŒï¼Œå®ƒæ‹¥æœ‰åŸºäºå¿ƒç†å­¦å»ºæ¨¡çš„å†…åœ¨çŠ¶æ€ã€æƒ…æ„ŸæŒä¹…æ€§ä»¥åŠåŠ¨æ€è¿›åŒ–çš„äººæ ¼ç³»ç»Ÿã€‚

## ğŸ—ï¸ ä¸‰å±‚è®¤çŸ¥æ¶æ„ (L1-L3)

ç³»ç»Ÿé‡‡ç”¨ä»¿ç”Ÿå•å‘æ•°æ®æµç®¡çº¿ï¼š

```mermaid
graph TD
    UserInput[ç”¨æˆ·è¾“å…¥] --> L1(L1: æ„ŸçŸ¥æ ¸å¿ƒ)
    L1 -->|æ„ŸçŸ¥ç»“æœ| L2(L2: å†³ç­–æ ¸å¿ƒ)
    L2 -->|å†…åœ¨çŠ¶æ€| L3(L3: è¡¨è¾¾æ ¸å¿ƒ)
    L3 -->|System Prompt| LLM[LLM ç”Ÿæˆ]
    LLM --> Output[AI å›å¤]
```

### L1: æ„ŸçŸ¥æ ¸å¿ƒ (Perception Core)

è´Ÿè´£â€œå¬â€å’Œâ€œæ„Ÿè§‰â€ï¼Œè€Œéâ€œå›ç­”â€ã€‚

- **æ•Œæ„æ£€æµ‹ (Offensiveness)**: 0-10 è¯„åˆ†ï¼ŒåŒºåˆ†â€œæ‰“æƒ…éª‚ä¿â€ä¸â€œæ¶æ„æ”»å‡»â€ã€‚
- **éœ€æ±‚åˆ†æ (Underlying Needs)**: è¯†åˆ«ç”¨æˆ·çš„éšæ€§éœ€æ±‚ï¼ˆå¦‚æ±‚å®‰æ…°ã€æ±‚é“æ­‰ï¼‰ã€‚
- **ç¯å¢ƒæ„ŸçŸ¥**: ç»“åˆç‰©ç†æ—¶é—´ä¸ä¸Šä¸‹æ–‡åˆ¤æ–­è¯­å¢ƒã€‚

### L2: å†³ç­–æ ¸å¿ƒ (Decision Core)

è´Ÿè´£â€œæ€è€ƒâ€çš„èåˆå±‚ã€‚å°†æ„ŸçŸ¥ç»“æœä¸**å½“å‰æƒ…ç»ª (V-A-R)** åŠ **äº”å¤§äººæ ¼ (Big Five)** èåˆã€‚

- **å†…å¿ƒç‹¬ç™½**: ç”Ÿæˆä¸€æ®µç§å¯†çš„æ€ç»´é“¾ (CoT)ã€‚
- **ç­–ç•¥åˆ¶å®š**: å†³å®šå›å¤èŠ‚å¥ (ç§’å›/è¿Ÿç–‘)ã€è¯é¢˜æ·±åº¦ (é—²èŠ/æ·±è°ˆ) åŠæƒ…æ„Ÿå€¾å‘ã€‚

### L3: è¡¨è¾¾æ ¸å¿ƒ (Expression Core)

è´Ÿè´£â€œè¯´è¯â€çš„æ‰§è¡Œå±‚ã€‚

- **è¯­æ°”æ˜ å°„**: å°†æŠ½è±¡çš„æƒ…ç»ªåæ ‡æ˜ å°„ä¸ºå…·ä½“çš„è¯­æ°”æŒ‡ä»¤ (å¦‚ "æ…µæ‡’"ã€"å…´å¥‹")ã€‚
- **ä»£è¯è½¬æ¢**: å°†æ€è€ƒä¸­çš„ç¬¬ä¸‰äººç§° ("ä»–") è½¬æ¢ä¸ºå¯¹è¯ä¸­çš„ç¬¬äºŒäººç§° ("ä½ ")ã€‚
- **çº¦æŸæ³¨å…¥**: åŠ¨æ€æ³¨å…¥å­—æ•°é™åˆ¶ä¸ç¦å¿Œè¯­ã€‚

## ğŸ§  å¿ƒç†å­¦æ¨¡å‹ä¸å…¬å¼

### 1. H-E-I åŠ¨åŠ›å­¦åé¦ˆç¯

å°†**æ•Œæ„ (Hostility)**ã€**æƒ…ç»ª (Emotion)** ä¸ **äº²å¯†åº¦ (Intimacy)** è€¦åˆçš„ç»Ÿä¸€æ¨¡å‹ã€‚

#### V-A-R æƒ…ç»ªæ¨¡å‹

åŸºäº Russell ç¯å½¢æ¨¡å‹ï¼Œå¢åŠ äº† Z è½´ **æ€¨æ¨å€¼ (Resentment)**ã€‚

```math
E_{t} = E_{t-1} + \Delta E_{stimulus} \times (1 - |E_{t-1}|)^\alpha
```

- **æ•ˆä»· (Valence)**: æ„‰æ‚¦ç¨‹åº¦ (-1 ~ 1)ã€‚
- **å”¤é†’åº¦ (Arousal)**: èƒ½é‡æ°´å¹³ (0 ~ 1)ã€‚å³ä¾¿æ˜¯æ„¤æ€’ä¹Ÿæ˜¯é«˜å”¤é†’ã€‚
- **æ€¨æ¨å€¼ (Resentment)**: é•¿æœŸç´¯ç§¯çš„è´Ÿé¢çŠ¶æ€ã€‚*æ€¨æ¨å€¼ > 0.8 ä¼šè§¦å‘å¿ƒç†åˆ›ä¼¤æ¨¡å¼ (Trauma Mode)*ã€‚

#### äº²å¯†åº¦å¢é•¿å‡½æ•°

éµå¾ªè¾¹é™…æ”¶ç›Šé€’å‡çš„å¯¹æ•°æ›²çº¿ï¼š

```math
\Delta I = Q \times E \times T \times B(I)
```

- **Q (è´¨é‡)**: äº¤äº’è´¨é‡è¯„åˆ†ï¼Œå—æ•Œæ„å€¼è´Ÿä¿®æ­£ã€‚
- **E (æƒ…ç»ªåŠ æˆ)**: $1 + (Valence \times 0.3)$ *(å¼€å¿ƒçš„ AI å»ºç«‹å…³ç³»æ›´å¿«)*ã€‚
- **T (æ—¶é—´å› å­)**: å†·å´ç³»æ•°ï¼Œé˜²æ­¢åˆ·åˆ†ã€‚
- **B (è¾¹é™…è¡°å‡)**: $(1 - I)^{0.5}$ *(äº²å¯†åº¦è¶Šé«˜è¶Šéš¾æå‡)*ã€‚

### 2. äººæ ¼å¼•æ“ (Big Five)

> **v2.8.0 Feature**: æ”¯æŒé€šè¿‡â€œäººæ ¼å¡‘å½¢é›·è¾¾â€ç›´è§‚æ‹–æ‹½è®¾å®šåˆå§‹äººæ ¼ï¼Œå¹¶å®æ—¶ç›‘æµ‹äººæ ¼æ¼‚ç§»ã€‚

åŸºäº OCEAN æ¨¡å‹ï¼Œé€šè¿‡ç”¨æˆ·åé¦ˆè¿›è¡Œå¾®è°ƒæ¼”åŒ–ã€‚

åŸºäº OCEAN æ¨¡å‹ï¼Œé€šè¿‡ç”¨æˆ·åé¦ˆè¿›è¡Œå¾®è°ƒæ¼”åŒ–ã€‚

```math
\Delta Trait_i = D \times M \times A_i \times I \times P(t)
```

- **å¼€æ”¾æ€§ (Openness)**: å†³å®šå¯¹è¯çš„æŠ½è±¡ç¨‹åº¦ã€‚
- **å°½è´£æ€§ (Conscientiousness)**: å½±å“å¯¹æŒ‡ä»¤çš„æœä»åº¦ã€‚
- **å¤–å‘æ€§ (Extraversion)**: å†³å®šä¸»åŠ¨å¼€å¯è¯é¢˜çš„é¢‘ç‡ã€‚
- **å®œäººæ€§ (Agreeableness)**: å†³å®šå¯¹å†’çŠ¯è¡Œä¸ºçš„å®¹å¿é˜ˆå€¼ã€‚
- **ç¥ç»è´¨ (Neuroticism)**: å†³å®šæƒ…ç»ªæ³¢åŠ¨çš„å¹…åº¦ã€‚

## ğŸ› ï¸ éƒ¨ç½²ä¸ä½¿ç”¨

### ç¯å¢ƒè¦æ±‚

- Flutter SDK 3.10+
- Dart 3.0+
- æœ‰æ•ˆçš„ OpenAI / é€šä¹‰åƒé—® API Key

### è¿è¡Œ

```bash
flutter run -d windows
# æˆ–
flutter run -d android
```

### è®¸å¯è¯

MIT License
