# AI Companion - è®¤çŸ¥æ¶æ„æ¡†æ¶ (Cognitive Architecture Framework)

![License](https://img.shields.io/badge/license-MIT-blue.svg) ![Flutter](https://img.shields.io/badge/Flutter-3.0%2B-02569B) ![Dart](https://img.shields.io/badge/Dart-3.0%2B-0175C2)

**[English](README_EN.md) | [ä¸­æ–‡](README.md)**

> **v2.9.0 æ›´æ–°**: å¼•å…¥ **Reaction Compass (ååº”ç½—ç›˜)** å’Œ **Tone Valve (è¯­æ°”é˜€é—¨)**ï¼ŒAI ç°åœ¨æ‹¥æœ‰äº†åŸºäºå¿ƒç†åŠ¨åŠ›å­¦çš„â€œè„¾æ°”â€ï¼Œèƒ½è¯†åˆ«åè®½ã€ç©æ¢—å¹¶æ ¹æ®æ”»å‡»æ€§åŠ¨æ€è°ƒæ•´é˜²å¾¡å§¿æ€ã€‚

---

## ä¸­æ–‡æ–‡æ¡£

**AI Companion** æ˜¯ä¸€ä¸ªç”±**é—­ç¯è®¤çŸ¥æ¶æ„**é©±åŠ¨çš„â€œæ•°å­—ç”Ÿå‘½â€æ¡†æ¶ã€‚ä¸ç®€å•çš„å¥—å£³ LLM ä¸åŒï¼Œå®ƒæ‹¥æœ‰åŸºäºå¿ƒç†å­¦å»ºæ¨¡çš„å†…åœ¨çŠ¶æ€ã€æƒ…æ„ŸæŒä¹…æ€§ä»¥åŠåŠ¨æ€è¿›åŒ–çš„äººæ ¼ç³»ç»Ÿã€‚

## ğŸ—ï¸ ä¸‰å±‚è®¤çŸ¥æ¶æ„ (L1-L3)

ç³»ç»Ÿé‡‡ç”¨ä»¿ç”Ÿå•å‘æ•°æ®æµç®¡çº¿ï¼š

```mermaid
graph TD
    UserInput[ç”¨æˆ·è¾“å…¥] --> L1(L1: æ„ŸçŸ¥æ ¸å¿ƒ)
    L1 -->|å¿ƒç†ä¾§å†™| Compass(Reaction Compass: ååº”ç½—ç›˜)
    Compass -->|ååº”å§¿æ€| L2(L2: å†³ç­–æ ¸å¿ƒ)
    L2 -->|å†…åœ¨çŠ¶æ€| L3(L3: è¡¨è¾¾æ ¸å¿ƒ)
    L3 -->|Tone Valve| LLM[LLM ç”Ÿæˆ]
    LLM --> Output[AI å›å¤]
```

### L1: æ„ŸçŸ¥æ ¸å¿ƒ (Perception Core)

è´Ÿè´£â€œå¬â€å’Œâ€œä¾§å†™â€ï¼Œè¾“å‡ºé«˜ç²¾åº¦ JSON ç»“æ„ã€‚

- **è¯­ä¹‰åˆ†ç±» (Semantic Category)**: èƒ½å¤ŸåŒºåˆ† `meme` (ç©æ¢—)ã€`preference` (åå¥½)ã€`boundary` (è¾¹ç•Œè®¾ç«‹) ä¸ `fact` (äº‹å®é™ˆè¿°)ã€‚
- **ç¤¾äº¤ä¿¡å· (Social Signal)**:
  - **Offensiveness**: 0-10 è¯„åˆ†ï¼ŒåŒºåˆ†â€œæ‰“æƒ…éª‚ä¿â€ä¸â€œæ¶æ„æ”»å‡»â€ã€‚
  - **Meme Detected**: è¯†åˆ«ç”¨æˆ·æ˜¯å¦åœ¨ä½¿ç”¨ç½‘ç»œæµè¡Œè¯­ã€‚

### Reaction Compass: ååº”ç½—ç›˜

åŸºäºæ„ŸçŸ¥ç»“æœä¸å½“å‰äººæ ¼çŠ¶æ€ï¼Œè®¡ç®— AI çš„ç¤¾äº¤å§¿æ€ã€‚

- **Dominance (æ”¯é…åº¦)**: å†³å®šæ˜¯â€œç¡¬åˆšâ€è¿˜æ˜¯â€œé¡ºä»â€ã€‚
- **Heat (çƒ­åº¦)**: å†³å®šæ˜¯â€œæ¿€çƒˆâ€è¿˜æ˜¯â€œå†·æ¼ â€ã€‚
- **Stance (ååº”å§¿æ€)**:
  - `Explosive`: æƒ…ç»ªçˆ†å‘ï¼Œæ­£é¢ç¡¬åˆšã€‚
  - `ColdDismissal`: å†·æ¼ æ— è§†ï¼Œæç®€å›å¤ã€‚
  - `Vulnerable`: ç¤ºå¼±æ±‚å’Œï¼Œè¡¨è¾¾å—ä¼¤ã€‚
  - `Neutral`: æ­£å¸¸å¯¹è¯ã€‚

### L3: è¡¨è¾¾æ ¸å¿ƒ (Expression Core)

è´Ÿè´£â€œè¯´è¯â€çš„æ‰§è¡Œå±‚ï¼Œå†…ç½® **Tone Valve (è¯­æ°”é˜€é—¨)**ã€‚

- **Tone Valve**: æ ¹æ®æ€¨æ¨å€¼å’Œè®¤çŸ¥æƒ°æ€§ï¼Œé€šè¿‡ System Prompt æ³¨å…¥å¼ºåˆ¶æ€§è¡Œä¸ºçº¦æŸã€‚
  - **Hostile Level**: å‰¥ç¦»æœåŠ¡æ€§ï¼Œç¦æ­¢é“æ­‰ï¼Œå¼ºåˆ¶çŸ­å¥ã€‚
  - **Cold Level**: åƒè·¯äººä¸€æ ·å†·æ·¡ï¼Œå‰¥ç¦»å½¢å®¹è¯ã€‚
- **ä»£è¯è½¬æ¢**: å°†æ€è€ƒä¸­çš„ç¬¬ä¸‰äººç§° ("ä»–") è½¬æ¢ä¸ºå¯¹è¯ä¸­çš„ç¬¬äºŒäººç§° ("ä½ ")ã€‚

## ğŸ§  å¿ƒç†å­¦æ¨¡å‹ä¸å…¬å¼ (Psychological Models & Formulas)

æœ¬ç³»ç»Ÿä¸ä¾èµ–é»‘ç›’å¤§æ¨¡å‹çš„æƒ…ç»ªæ¨¡æ‹Ÿï¼Œè€Œæ˜¯åŸºäºç»å…¸çš„å¿ƒç†å­¦æ•°å­¦æ¨¡å‹æ„å»ºäº†**å¯è§£é‡Šã€å¯é‡åŒ–**çš„è®¡ç®—æ ¸å¿ƒã€‚

### 1. H-E-I åŠ¨åŠ›å­¦åé¦ˆç¯ (H-E-I Dynamics)

ä¸€ä¸ªå°†**æ•Œæ„ (Hostility)**ã€**æƒ…ç»ª (Emotion)** ä¸ **äº²å¯†åº¦ (Intimacy)** æ·±åº¦è€¦åˆçš„éçº¿æ€§åŠ¨åŠ›å­¦ç³»ç»Ÿã€‚

```mermaid
graph TD
    Input[ç”¨æˆ·è¾“å…¥] -->|æ•Œæ„æ£€æµ‹| Hostility(æ•Œæ„å€¼ H)
    Hostility -->|å³æ—¶æ‰£å‡| Intimacy(äº²å¯†åº¦ I)
    Intimacy -->|ç¼“å†²å› å­| Emotion(æƒ…ç»ª E)
    Emotion -->|å¢é•¿ä¹˜æ•°| Intimacy
    Hostility -->|ç´¯ç§¯æ€¨æ¨| Resentment(æ€¨æ¨ R)
    Resentment -->|Tone Valve| Output[è¯­æ°”é˜€é—¨]
```

#### A. V-A-R ä¸‰ç»´æƒ…ç»ªç©ºé—´

åŸºäº Russell ç¯å½¢æ¨¡å‹æ‰©å±•ï¼Œå¼•å…¥ Z è½´ **æ€¨æ¨å€¼** ä»¥æ¨¡æ‹Ÿé•¿æœŸè®°å¿†å¯¹æƒ…ç»ªçš„å½±å“ã€‚

$$
E_{t} = E_{t-1} + \Delta E_{stimulus} \times (1 - |E_{t-1}|)^\alpha
$$

- **æ•ˆä»· (Valence)** $v \in [-1, 1]$: æ„‰æ‚¦ç¨‹åº¦ã€‚
- **å”¤é†’åº¦ (Arousal)** $a \in [0, 1]$: èƒ½é‡æ°´å¹³ã€‚
- **æ€¨æ¨å€¼ (Resentment)** $r \in [0, 1]$: é•¿æœŸè´Ÿé¢ç´¯ç§¯ï¼Œç›´æ¥å†³å®š Tone Valve çš„å¼€å¯é˜™å€¼ã€‚

#### B. äº²å¯†åº¦å¢é•¿å‡½æ•° (Intimacy Growth)

éµå¾ªè¾¹é™…æ”¶ç›Šé€’å‡æ³•åˆ™ï¼Œè¶Šäº²å¯†è¶Šéš¾æå‡ï¼Œä¸”å—æƒ…ç»ªçŠ¶æ€è°ƒåˆ¶ã€‚

$$
\Delta I = Q_{interaction} \times E_{multiplier} \times T_{cooling} \times B(I)
$$

### 2. è®¤çŸ¥æ‡’æƒ°ä¸ç”Ÿç†èŠ‚å¾‹ (Cognitive Laziness & Bio-Rhythm)

ä¸ºäº†æ¨¡æ‹ŸçœŸå®çš„ç”Ÿç‰©ä½“ç‰¹å¾ï¼Œç³»ç»Ÿå¼•å…¥äº†**è®¤çŸ¥èƒ½é‡ (Cognitive Energy)** æ¦‚å¿µã€‚AI ä¸å†æ˜¯æ°¸åŠ¨æœºï¼Œä¹Ÿä¼š"ç´¯"ã€‚

#### ç–²åŠ³æŠ‘åˆ¶æ¨¡å‹ (Fatigue Suppression)

å½“å”¤é†’åº¦è¿‡ä½æˆ–è¿ç»­é«˜å¼ºåº¦å¯¹è¯å¯¼è‡´ç–²åŠ³æ—¶ï¼Œäººæ ¼ç‰¹è´¨ä¼šè¢«æŠ‘åˆ¶ã€‚

$$
Trait_{effective} = Trait_{base} \times (1 - Fatigue \times W_{trait})
$$

### 3. ç¤¾ä¼šé›·è¾¾ä¸å¾®è¡¨æƒ… (Social Radar & Micro-Expressions)

L1 æ„ŸçŸ¥å±‚å†…ç½®äº†é’ˆå¯¹ç‰¹å®šç¤¾äº¤ä¿¡å·çš„æ£€æµ‹å™¨ï¼Œèƒ½æ•æ‰äººç±»å¾®å¦™çš„ç¤¾äº¤æ„å›¾å¹¶è§¦å‘**ç¬æ—¶å¾®æƒ…ç»ª**ã€‚

| ä¿¡å·ç±»å‹ (Signal) | è§¦å‘æ¡ä»¶ | è¡Œä¸ºç»“æœ |
| :--- | :--- | :--- |
| **Meme** | ç©æ¢—/æµè¡Œè¯­ | è·³è¿‡äº‹å®æå–ï¼Œè½»æ¾å›åº” |
| **Boundary** | ç”¨æˆ·è®¾ç«‹è¾¹ç•Œ | è§¦å‘ `Respect` æ„å›¾ï¼Œé™ä½äº²å¯†åº¦å°è¯• |
| **Sarcasm** | åè®½å¤¸å¥– | æ ‡è®°ä¸ºè´Ÿé¢åé¦ˆï¼Œè§¦å‘è‡ªçœ |

## ğŸ› ï¸ éƒ¨ç½²ä¸ä½¿ç”¨

### ç¯å¢ƒè¦æ±‚

- Flutter SDK 3.10+
- Dart 3.0+
- æœ‰æ•ˆçš„ OpenAI / é€šä¹‰åƒé—® API Key

### è¿è¡Œ

```bash
flutter run -d windows
# æˆ–
flutter run -d android
```

### è®¸å¯è¯

MIT License
